# Car Detection on BDD100K using YOLOv8

This project implements a **single-class car detection pipeline** on the BDD100K dataset using **Ultralytics YOLOv8**.  
The workflow includes annotation conversion, dataset analysis, downsampling, model fine-tuning, and evaluation on validation and test splits.

---

## Dataset
- **Dataset**: BDD100K
- **Task**: Car detection (single class)
- **Original annotations**: JSON format
- **Converted to**: YOLO format (`.txt`)

> Due to size constraints, the BDD100K dataset (images and labels) is **not included** in this repository.

Expected dataset structure after download and preprocessing:


bdd100k_images_100k/100k/{train,val,test}/
bdd100k_labels/100k/{train,val,test}/


## Preprocessing
The following preprocessing steps are performed:

1. **JSON â†’ YOLO label conversion**  
   Extracts only `car` bounding boxes and converts them into YOLO format.
2. **Dataset analysis**
   - Object size distribution
   - Truncated vs non-truncated objects
   - Time-of-day vs weather distribution
3. **Downsampling**
   Training data is downsampled using stratified sampling (by time-of-day) to reduce compute cost while preserving data diversity.

Scripts are available under:
## Training
Model training is performed using the Ultralytics YOLOv8 command-line interface.

```bash
bash training/train.sh
```
Which runs:

bash
```
yolo detect train \
  data=configs/bdd_car_small.yaml \
  model=yolov8s.pt \
  imgsz=640 \
  epochs=50 \
  batch=-1 \
  device=0
Evaluation
Validation and test evaluation are performed using:
```
bash
```
bash training/val.sh
bash training/test.sh
```

These commands compute:

Precision

Recall

mAP@0.5

mAP@0.5:0.95

Results
| Split | Precision | Recall | mAP@0.5 | mAP@0.5:0.95 |
|------|-----------|--------|----------|--------------|
| Val  | 0.832     | 0.673  | 0.765    | 0.475        |
| Test | 0.833     | 0.671  | 0.766    | 0.475        |


Inference speed is approximately 3 ms per image on an NVIDIA RTX 4060 GPU.

Inference
To generate qualitative results on the test set:

bash
Copy code
yolo detect predict \
  model=runs/detect/exp_wandb2/weights/best.pt \
  source=bdd_small/images/test \
  conf=0.5 \
  save=True
Predicted images are saved under:

bash
Copy code
runs/detect/
Repository Structure
pgsql
Copy code
configs/        # Dataset configuration files
preprocessing/  # Label conversion, analysis, downsampling
training/       # Training, validation, test scripts
results/        # Metrics and selected qualitative outputs
runs/           # Auto-generated YOLO outputs (ignored)
Notes
The runs/ directory is auto-generated by YOLO and excluded from version control.

Trained model weights (*.pt) are not included.

The model is fine-tuned from pretrained YOLOv8 weights, not trained from scratch.

All experiments are reproducible using the provided scripts.

Requirements
Install dependencies with:

bash
pip install -r requirements.txt
